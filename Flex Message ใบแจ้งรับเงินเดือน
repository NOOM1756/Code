//„Äå üê∏üê∏üê∏ ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏ä‡∏µ‡∏ó‡∏ä‡∏∑‡πà‡∏≠ SETTING üê∏üê∏üê∏ „Äç
var file = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('SETTING');  //üßø‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡πÅ‡∏´‡∏•‡πà‡∏á‡∏ñ‡∏∂‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà ‡πÉ‡∏ô‡∏ä‡∏µ‡∏ó‡∏ó‡∏µ‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡πà‡∏≤ "SETTING"üí•
var file_id = file.getRange('C5').getValue();                                //üßø‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡∏µ‡∏ó‡πÑ‡∏≠‡∏î‡∏µ > ‡∏î‡∏∂‡∏á‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡πÄ‡∏ã‡∏•‡πå C5
var token_line = file.getRange('C6').getValue();                             //üßø‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏ó‡πÄ‡∏Ñ‡πà‡∏ô > ‡∏î‡∏∂‡∏á‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡πÄ‡∏ã‡∏•‡πå C6

var CHANNEL_ACCESS_TOKEN = token_line;
var line_endpoint = 'https://api.line.me/v2/bot/message/reply';

var data_sheet = SpreadsheetApp.openById(file_id).getSheets() [0];             //üßø‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏à‡∏≤‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà 2 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏≠‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏ä‡∏µ‡∏ó‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÑ‡∏õ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏≤
// var data_table = data_sheet.getRange(2, 1, data_sheet.getLastRow(), data_sheet.getLastColumn()).getValues(); //üßø‡∏ö‡∏≠‡∏Å‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï‡∏Ç‡∏≠‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÑ‡∏õ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏≤
var data_table = data_sheet.getRange(2, 1, data_sheet.getLastRow() - 1, data_sheet.getLastColumn()).getValues(); 
var result = '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤';  //üßø‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤'‚ö†Ô∏è#A1
// ‚úÇ„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞ ‡∏à‡∏ö SETTING ‚¨õÔ∏è



//„Äå üê∏üê∏üê∏ ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡πà‡∏ô doPost üê∏üê∏üê∏ „Äç
function doPost(e) {
  var json = JSON.parse(e.postData.contents);     // üßø ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° (‡∏à‡∏≤‡∏Å‡∏†‡∏≤‡∏©‡∏≤ JSON ‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤ JavaScript)
  var message = json.events[0].message.text;      // üßø ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏´‡∏¢‡∏¥‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÅ‡∏õ‡∏•‡∏°‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡πà‡∏≤‡∏ô
  var reply_token = json.events[0].replyToken;    // üßø ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô ‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÇ‡∏ó‡πÄ‡∏Ñ‡πà‡∏ô (Token ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏™‡∏°‡∏∑‡∏≠‡∏ô ID CARD ‡∏´‡∏£‡∏∑‡∏≠ PASSPORT)

  for (var i = 0; i < data_table.length; i++) {
    if (data_table[i][0] == message) // üßø‡∏ñ‡πâ‡∏≤‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡∏°‡∏≤‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Google Sheet ‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà i ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå A 
    // üßø(‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå A=0, B=1, C=2 ‡πÑ‡∏•‡πà‡πÑ‡∏õ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢ ‡πÜ ‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÑ‡∏´‡∏ô) 
    {
      i = i + 2;
      var column_A = data_sheet.getRange(i, 1).getValue();   // üßø‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ó‡∏´‡∏≤‡∏£ 
      var column_B = data_sheet.getRange(i, 2).getValue();   // üßø‡∏¢‡∏® - ‡∏ä‡∏∑‡πà‡∏≠ - ‡∏™‡∏Å‡∏∏‡∏•
      var column_C = data_sheet.getRange(i, 3).getValue();   // üßø‡∏£‡∏∞‡∏î‡∏±‡∏ö ‡∏ä‡∏±‡πâ‡∏ô 
      var column_D = data_sheet.getRange(i, 4).getValue();   // üßø‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏à‡∏≥
      
      var column_F = data_sheet.getRange(i, 6).getValue();   // üßø‡∏û.‡∏™.‡∏£.(‡∏ö‡∏ó‡∏ä.)‡∏Ñ‡∏£‡∏±‡πâ‡∏á3           
      var column_G = data_sheet.getRange(i, 7).getValue();   // üßø‡∏û.‡∏™.‡∏£.(‡∏ö‡∏ó‡∏ä.)‡∏Ñ‡∏£‡∏±‡πâ‡∏á4 
      var column_H = data_sheet.getRange(i, 8).getValue();   // üßø‡∏û.‡∏™.‡∏£.(‡∏ö‡∏ó‡∏ä.)‡∏Ñ‡∏£‡∏±‡πâ‡∏á2 
      var column_I = data_sheet.getRange(i, 9).getValue();   // üßø‡∏û.‡∏ä.‡∏Ñ.‡∏Ç.
      
      var column_K = data_sheet.getRange(i, 11).getValue();  // üßø‡∏û.‡∏™.‡∏£.(‡∏ö‡∏ó‡∏ä.)‡∏Ñ‡∏£‡∏±‡πâ‡∏á1
      var column_L = data_sheet.getRange(i, 12).getValue();  // üßø‡∏£‡∏ß‡∏°‡∏£‡∏±‡∏ö
      
      var column_N = data_sheet.getRange(i, 14).getValue();   // üßø‡∏Å‡∏ö‡∏Ç./‡∏ï‡∏Å‡πÄ‡∏ö‡∏¥‡∏Å, ‡∏Å‡∏™‡∏à./‡∏ï‡∏Å‡πÄ‡∏ö‡∏¥‡∏Å
      var column_O = data_sheet.getRange(i, 15).getValue();   // üßø‡∏Å‡∏ö‡∏Ç.‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°/‡∏ï‡∏Å‡πÄ‡∏ö‡∏¥‡∏Å 
      
      var column_Q = data_sheet.getRange(i, 17).getValue();   // üßø‡∏á‡∏Å.‡∏Å‡∏¢‡∏®.‡∏û‡∏£‡∏ö60 
            
      var column_S = data_sheet.getRange(i, 19).getValue();   // üßø‡∏Ñ‡πà‡∏≤‡∏´‡∏∏‡πâ‡∏ô‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Ø 
      var column_T = data_sheet.getRange(i, 20).getValue();   // üßø‡∏Å‡∏π‡πâ ‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå
      
      var column_Z = data_sheet.getRange(i, 26).getValue();   // üßø‡∏≠‡∏ó‡∏ö.‡∏ù‡∏≤‡∏Å
      var column_AA = data_sheet.getRange(i, 27).getValue();   // üßø‡∏≠‡∏ó‡∏ö.‡∏ù‡∏≤‡∏Å‡∏™‡∏°‡∏ó‡∏ö
      var column_AB = data_sheet.getRange(i, 28).getValue();   // üßø‡∏≠‡∏ó‡∏ö.‡∏ö‡∏≥‡∏ö‡∏±‡∏î‡∏ó‡∏∏‡∏Å‡∏Ç‡πå
     
      var column_AJ = data_sheet.getRange(i, 36).getValue();  // üßø‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥‡∏õ‡∏£‡∏∞‡∏õ‡∏≤
      
      var column_AL = data_sheet.getRange(i, 38).getValue();   // üßø‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏ö‡πâ‡∏≤‡∏ô‡∏û‡∏±‡∏Å
      var column_AM = data_sheet.getRange(i, 39).getValue();   // üßø‡∏å‡∏≤‡∏õ‡∏ô‡∏Å‡∏¥‡∏à ‡∏ó‡∏ö. 
      
      var column_AT = data_sheet.getRange(i, 46).getValue();  // üßøUBC
      
      var column_BG = data_sheet.getRange(i, 59).getValue();   // üßø‡∏Ç‡∏¢‡∏∞
      
      var column_BL = data_sheet.getRange(i, 64).getValue();   // üßø‡∏£‡∏ß‡∏°‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô
      var column_BM = data_sheet.getRange(i, 65).getValue();   // üßø‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠
      
      var column_BN = data_sheet.getRange(i, 66).getValue();   // üßø‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏ô  

      // var date = new Date(column_F);                                       // üßø‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô flex (‡∏ö‡∏≤‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ô‡∏µ‡πâ)
      //     date.setDate(date.getDate() + 1);                                // üßø‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô flex (‡∏ö‡∏≤‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ô‡∏µ‡πâ)
      // var formattedDate = Utilities.formatDate(date, "GMT", "dd/MM/yyyy"); // üßø‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô flex (‡∏ö‡∏≤‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ô‡∏µ‡πâ)

      result =

      /* ‚ñ∞‚ñ±‚ñ∞‚ñ±‚ñ∞‚ñ±‚ñ∞‚ñ± üåî ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô Flex-simulator (üö©START) üåî ‚ñ∞‚ñ±‚ñ∞‚ñ±‚ñ∞‚ñ±‚ñ∞‚ñ± */
      {
        "type": "bubble",
        "size": "giga",
        "body": {
          "type": "box",
          "layout": "vertical",
          "contents": [
            {
              "type": "text",
              "text": "‡πÉ‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô",
              "weight": "bold",
              "color": "#1DB446",
              "size": "xl",
              "align": "center"
            },
            {
              "type": "text",
              "text": "‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏ô "+column_BN,
              "weight": "bold",
              "color": "#1DB446",
              "size": "md",
              "align": "center"
            },
            {
              "type": "text",
              "text": column_B,
              "weight": "bold",
              "color": "#330099",
              "size": "xxl",
              "align": "center"
            },
                        {
              "type": "separator",
              "margin": "xxl"
            },
            {
              "type": "box",
              "layout": "vertical",
              "margin": "xxl",
              "spacing": "sm",
              "contents": [
                {
                  "type": "box",
                  "layout": "horizontal",
                  "contents": [
                    {
                      "type": "text",
                      "text": "‡∏£‡∏∞‡∏î‡∏±‡∏ö/‡∏ä‡∏±‡πâ‡∏ô",
                      "size": "md",
                      "color": "#555555",
                      "weight": "bold"
                    },
                    {
                      "type": "text",
                      "text": column_C,
                      "color": "#111111",
                      "align": "end",
                      "size": "md",
                      "weight": "bold"
                    }
                  ]
                },
                {
                  "type": "box",
                  "layout": "horizontal",
                  "contents": [
                    {
                      "type": "text",
                      "text": "‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏Ñ‡πà‡∏≤‡∏à‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏à‡∏≥",
                      "size": "sm",
                      "color": "#555555"
                    },
                    {
                      "type": "text",
                      "text": column_D,
                      "size": "sm",
                      "color": "#00FF00",
                      "align": "end"
                    }
                  ]
                },
                {
                  "type": "box",
                  "layout": "horizontal",
                  "margin": "none",
                  "contents": [
                    {
                      "type": "text",
                      "text": "‡∏û.‡∏™.‡∏£.(‡∏ö‡∏ó‡∏ä.)‡∏Ñ‡∏£‡∏±‡πâ‡∏á 1",
                      "size": "sm",
                      "color": "#555555"
                    },
                    {
                      "type": "text",
                      "text": column_K,
                      "size": "sm",
                      "color": "#00FF00",
                      "align": "end"
                    }
                  ]
                },
                {
                  "type": "box",
                  "layout": "horizontal",
                  "contents": [
                    {
                      "type": "text",
                      "text": "‡∏û.‡∏™.‡∏£.(‡∏ö‡∏ó‡∏ä.)‡∏Ñ‡∏£‡∏±‡πâ‡∏á 2",
                      "size": "sm",
                      "color": "#555555"
                    },
                    {
                      "type": "text",
                      "text": column_H,
                      "size": "sm",
                      "color": "#00FF00",
                      "align": "end"
                    }
                  ]
                },
                {
                  "type": "box",
                  "layout": "horizontal",
                  "contents": [
                    {
                      "type": "text",
                      "text": "‡∏û.‡∏™.‡∏£.(‡∏ö‡∏ó‡∏ä.)‡∏Ñ‡∏£‡∏±‡πâ‡∏á 3",
                      "size": "sm",
                      "color": "#555555"
                    },
                    {
                      "type": "text",
                      "text": column_F,
                      "size": "sm",
                      "color": "#00FF00",
                      "align": "end"
                    }
                  ]
                },
                {
                  "type": "box",
                  "layout": "horizontal",
                  "contents": [
                    {
                      "type": "text",
                      "text": "‡∏û.‡∏™.‡∏£.(‡∏ö‡∏ó‡∏ä.)‡∏Ñ‡∏£‡∏±‡πâ‡∏á 4 ",
                      "size": "sm",
                      "color": "#555555"
                    },
                    {
                      "type": "text",
                      "text": column_G,
                      "size": "sm",
                      "color": "#00FF00",
                      "align": "end"
                    }
                  ]
                },
                {
                  "type": "box",
                  "layout": "horizontal",
                  "contents": [
                    {
                      "type": "text",
                      "text": "‡∏û.‡∏ä.‡∏Ñ.‡∏Ç.",
                      "size": "sm",
                      "color": "#555555"
                    },
                    {
                      "type": "text",
                      "text": column_I,
                      "align": "end",
                      "size": "sm",
                      "color": "#00FF00"
                    }
                  ]
                },
                {
                  "type": "box",
                  "layout": "horizontal",
                  "contents": [
                    {
                      "type": "text",
                      "text": "‡∏£‡∏ß‡∏°‡∏£‡∏±‡∏ö",
                      "color": "#555555",
                      "size": "md",
                      "weight": "bold"
                    },
                    {
                      "type": "text",
                      "text": column_L,
                      "align": "end",
                      "color": "#00FF00",
                      "size": "md",
                      "weight": "bold"
                    }
                  ]
                }
              ]
            },
            {
              "type": "separator",
              "margin": "sm"
            },
            {
              "type": "box",
              "layout": "horizontal",
              "contents": [
                {
                  "type": "text",
                  "size": "sm",
                  "color": "#555555",
                  "text": "‡∏Å‡∏ö‡∏Ç./‡∏ï‡∏Å‡πÄ‡∏ö‡∏¥‡∏Å, ‡∏Å‡∏™‡∏à./‡∏ï‡∏Å‡πÄ‡∏ö‡∏¥‡∏Å"
                },
                {
                  "type": "text",
                  "text": column_N,
                  "align": "end",
                  "color": "#FF0000",
                  "size": "sm"
                }
              ],
              "margin": "lg"
            },
            {
              "type": "box",
              "layout": "horizontal",
              "contents": [
                {
                  "type": "text",
                  "text": "‡∏Å‡∏ö‡∏Ç.‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°/‡∏ï‡∏Å‡πÄ‡∏ö‡∏¥‡∏Å ",
                  "size": "sm",
                  "color": "#555555"
                },
                {
                  "type": "text",
                  "text": column_O,
                  "align": "end",
                  "color": "#FF0000",
                  "size": "sm"
                }
              ]
            },
            {
              "type": "box",
              "layout": "horizontal",
              "contents": [
                {
                  "type": "text",
                  "text": "‡∏á‡∏Å.‡∏Å‡∏¢‡∏®.‡∏û‡∏£‡∏ö.60 ",
                  "size": "sm",
                  "color": "#555555"
                },
                {
                  "type": "text",
                  "text": column_Q,
                  "align": "end",
                  "color": "#FF0000",
                  "size": "sm"
                }
              ]
            },
            {
              "type": "box",
              "layout": "horizontal",
              "contents": [
                {
                  "type": "text",
                  "text": "‡∏≠‡∏ó‡∏ö.‡∏ù‡∏≤‡∏Å",
                  "size": "sm",
                  "color": "#555555"
                },
                {
                  "type": "text",
                  "text": column_Z,
                  "align": "end",
                  "color": "#FF0000",
                  "size": "sm"
                }
              ]
            },
            {
              "type": "box",
              "layout": "horizontal",
              "contents": [
                {
                  "type": "text",
                  "text": "‡∏≠‡∏ó‡∏ö.‡∏ù‡∏≤‡∏Å‡∏™‡∏°‡∏ó‡∏ö",
                  "color": "#555555",
                  "size": "sm"
                },
                {
                  "type": "text",
                  "text": column_AA,
                  "align": "end",
                  "color": "#FF0000",
                  "size": "sm"
                }
              ]
            },
            {
              "type": "box",
              "layout": "horizontal",
              "contents": [
                {
                  "type": "text",
                  "text": "‡∏Ç‡∏¢‡∏∞",
                  "color": "#555555",
                  "size": "sm"
                },
                {
                  "type": "text",
                  "text": column_BG,
                  "align": "end",
                  "color": "#FF0000",
                  "size": "sm"
                }
              ]
            },
            {
              "type": "box",
              "layout": "horizontal",
              "contents": [
                {
                  "type": "text",
                  "text": "‡∏≠‡∏ó‡∏ö.‡∏ö‡∏≥‡∏ö‡∏±‡∏î‡∏ó‡∏∏‡∏Å‡∏Ç‡πå",
                  "color": "#555555",
                  "size": "sm"
                },
                {
                  "type": "text",
                  "text": column_AB,
                  "align": "end",
                  "color": "#FF0000",
                  "size": "sm"
                }
              ]
            },
            {
              "type": "box",
              "layout": "horizontal",
              "contents": [
                {
                  "type": "text",
                  "text": "‡∏å‡∏≤‡∏õ‡∏ô‡∏Å‡∏¥‡∏à ‡∏ó‡∏ö.",
                  "color": "#555555",
                  "size": "sm"
                },
                {
                  "type": "text",
                  "text": column_AM,
                  "align": "end",
                  "color": "#FF0000",
                  "size": "sm"
                }
              ]
            },
            {
              "type": "box",
              "layout": "horizontal",
              "contents": [
                {
                  "type": "text",
                  "text": "UBC",
                  "color": "#555555",
                  "size": "sm"
                },
                {
                  "type": "text",
                  "text": column_AT,
                  "align": "end",
                  "color": "#FF0000",
                  "size": "sm"
                }
              ]
            },
            {
              "type": "box",
              "layout": "horizontal",
              "contents": [
                {
                  "type": "text",
                  "text": "‡∏Å‡∏π‡πâ ‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏≠‡∏≠‡∏°‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå",
                  "size": "sm",
                  "color": "#555555"
                },
                {
                  "type": "text",
                  "text": column_T,
                  "align": "end",
                  "color": "#FF0000",
                  "size": "sm"
                }
              ]
            },
            {
              "type": "box",
              "layout": "horizontal",
              "contents": [
                {
                  "type": "text",
                  "text": "‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥‡∏õ‡∏£‡∏∞‡∏õ‡∏≤",
                  "size": "sm",
                  "color": "#555555"
                },
                {
                  "type": "text",
                  "text": column_AJ,
                  "align": "end",
                  "color": "#FF0000",
                  "size": "sm"
                }
              ]
            },
            {
              "type": "box",
              "layout": "horizontal",
              "contents": [
                {
                  "type": "text",
                  "text": "‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏ö‡πâ‡∏≤‡∏ô‡∏û‡∏±‡∏Å",
                  "size": "sm",
                  "color": "#555555"
                },
                {
                  "type": "text",
                  "text": column_AL,
                  "color": "#FF0000",
                  "size": "sm",
                  "align": "end"
                }
              ]
            },
            {
              "type": "box",
              "layout": "horizontal",
              "contents": [
                {
                  "type": "text",
                  "text": "‡∏Ñ‡πà‡∏≤‡∏´‡∏∏‡πâ‡∏ô‡∏™‡∏´‡∏Å‡∏£‡∏ì‡πå‡∏Ø ",
                  "size": "sm",
                  "color": "#555555",
                  "flex": 0
                },
                {
                  "type": "text",
                  "text": column_S,
                  "size": "sm",
                  "color": "#FF0000",
                  "align": "end"
                }
              ]
            },
            {
              "type": "box",
              "layout": "horizontal",
              "contents": [
                {
                  "type": "text",
                  "text": "‡∏£‡∏ß‡∏°‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô",
                  "size": "md",
                  "color": "#555555",
                  "flex": 0,
                  "weight": "bold"
                },
                {
                  "type": "text",
                  "text": column_BL,
                  "size": "md",
                  "color": "#FF0000",
                  "align": "end",
                  "weight": "bold"
                }
              ],
              "margin": "md"
            },
            {
              "type": "box",
              "layout": "horizontal",
              "contents": [
                {
                  "type": "text",
                  "text": "‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠",
                  "size": "lg",
                  "weight": "bold"
                },
                {
                  "type": "text",
                  "text": column_BM ,
                  "color": "#00FF00",
                  "size": "lg",
                  "weight": "bold",
                  "align": "end"
                }
              ]
            }
          ],
          "borderColor": "#FFCC00",
          "borderWidth": "normal"
        },
        "footer": {
          "type": "box",
          "layout": "vertical",
          "contents": [
            {
              "type": "button",
              "action": {
                "type": "uri",
                "label": "‡πÉ‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô",
                "uri": "http://linecorp.com/"
              },
              "margin": "none",
              "style": "primary",
              "color": "#FFCC00"
            }
          ]
        },
        "styles": {
          "footer": {
            "separator": true
          }
        }
      }
      /* ‚ñ∞‚ñ±‚ñ∞‚ñ±‚ñ∞‚ñ±‚ñ∞‚ñ± üåí ‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î Flex-simulator (üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†ÅøSTOP)  üåí ‚ñ∞‚ñ±‚ñ∞‚ñ±‚ñ∞‚ñ±‚ñ∞‚ñ± */
    };
  };


  if (result == '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤') { //üßø‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏•‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô ‚ö†Ô∏è#A1
    UrlFetchApp.fetch(line_endpoint, {
      'headers': {
        'Content-Type': 'application/json; charset=UTF-8',
        'Authorization': 'Bearer ' + CHANNEL_ACCESS_TOKEN,
      },
      'method': 'post',
      'payload': JSON.stringify({
        'replyToken': reply_token,
        'messages': [{
          'type': 'text',
          'text': result
        }],
      }),
    });
  }
  else {
    UrlFetchApp.fetch(line_endpoint, {
      'headers': {
        'Content-Type': 'application/json; charset=UTF-8',
        'Authorization': 'Bearer ' + CHANNEL_ACCESS_TOKEN,
      },
      'method': 'post',
      'payload': JSON.stringify({
        'replyToken': reply_token,
        'messages': [{
          'type': 'flex',
          'altText': '‡πÉ‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì',
          'contents': result
        }],
      }),
    });
  }
  return ContentService.createTextOutput(JSON.stringify({ 'content': 'post ok' })).setMimeType(ContentService.MimeType.JSON);
  //üßø‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á Output ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÄ‡∏õ‡πá‡∏ô JSON
}
// ‚úÇ„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞„Ä∞ ‡∏à‡∏ö‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡πà‡∏ô doPost ‚¨õÔ∏è

